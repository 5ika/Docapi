function toMarkdown(){if(preview){var e=editeur.getValue().length;1e4>e?md():waitForConvert||(waitForConvert=!0,setTimeout(function(){waitForConvert=!1,md()},1500))}}function md(){var e="";""!==$("#title").val()&&(e="# "+$("#title").val()+"\n");var t=e+editeur.getValue();t=t.replace(/(<script>)/gi,"[Javascript]\n"),t=t.replace(/(<\/script>)/gi,"\n[/Javascript]");var a=marked(t);$("#view").html(a)}function togglePreview(){preview?($("#editor").addClass("m12").removeClass("m6"),$("#view").hide(),$(".fa-eye-slash").removeClass("fa-eye-slash").addClass("fa-eye")):($("#editor").addClass("m6").removeClass("m12"),$("#view").show(),$(".fa-eye").removeClass("fa-eye").addClass("fa-eye-slash"),md()),preview=!preview}function toggleNumberedTitles(){$("#view").toggleClass("numbered-view")}function toggleFullscreen(){editeur.getOption("fullScreen")?editeur.setOption("fullScreen",!1):editeur.setOption("fullScreen",!0),$(".btn-fullscreen-disable").toggleClass("hide")}function parameters(){"none"==$("#modal-parameters").css("display")?$("#modal-parameters").openModal():$("#modal-parameters").closeModal()}function getTags(){var e=$("#tags").val(),t=e.split(/[,;] */);return t.join(", ")}function send(){if(editeur.getValue()!=lastContent||forceSave)if(""!==$("#title").val()){console.log("Sauvegarde");var e={document:{title:$("#title").val(),content:editeur.getValue(),tags:getTags(),username:$("#username").val(),context:$("#context").val(),toc:$("#toc").is(":checked")||!1}};0!==id&&(e._id=id,$(".link-"+id+" .doc-title").text(e.document.title)),$.post("/api",e,function(t){if(t&&!t.hasOwnProperty("error")){id=t.id,toast(t.message,2e3);var a=new Date,n=a.getHours()+":"+a.getMinutes();$("#last-save").text("Dernière sauvegarde à "+n),lastContent=e.document.content,t.redirectToEdit&&(window.location.href="/"+id)}else toast("Problème serveur. Document non sauvé.",2e3)})}else toast("Pas de titre. Document non sauvé",2e3)}function del(){0!==id?$.ajax({url:"/api/"+id,type:"DELETE",success:function(e){window.location.href="/"}}):toast("Document non sauvé",2e3)}function newDocument(){window.location.href="/"}var toast=Materialize.toast,preview=!1,lastContent="",waitForConvert=!1,editeur;$(document).ready(function(){$(".modal-trigger").leanModal(),$(".link-"+id).addClass("active"),toMarkdown(),editeur=CodeMirror.fromTextArea($("textarea")[0]),editeur.on("change",toMarkdown),window.setInterval(function(){""!==$("#title").val()&&""!==$("#content").val()&&send()},6e4)}),$("textarea").keydown(function(e){if(9===e.keyCode){var t=this.selectionStart,a=this.selectionEnd,n=$(this),o=n.val();n.val(o.substring(0,t)+"	"+o.substring(a)),this.selectionStart=this.selectionEnd=t+1,e.preventDefault()}}),$(document).keydown(function(e){if(console.log(e.keyCode),e.ctrlKey){switch(e.keyCode){case 83:send();break;case 78:newDocument();break;case 79:togglePreview();break;case 80:toggleFullscreen()}e.preventDefault()}});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRvb2xzLmpzIiwiZWRpdG9yLmpzIl0sIm5hbWVzIjpbInRvTWFya2Rvd24iLCJwcmV2aWV3IiwiY2hhckNvdW50IiwiZWRpdGV1ciIsImdldFZhbHVlIiwibGVuZ3RoIiwibWQiLCJ3YWl0Rm9yQ29udmVydCIsInNldFRpbWVvdXQiLCJ0aXRyZSIsIiQiLCJ2YWwiLCJjb250ZW50IiwicmVwbGFjZSIsIm1kQ29udGVudCIsIm1hcmtlZCIsImh0bWwiLCJ0b2dnbGVQcmV2aWV3IiwiYWRkQ2xhc3MiLCJyZW1vdmVDbGFzcyIsImhpZGUiLCJzaG93IiwidG9nZ2xlTnVtYmVyZWRUaXRsZXMiLCJ0b2dnbGVDbGFzcyIsInRvZ2dsZUZ1bGxzY3JlZW4iLCJnZXRPcHRpb24iLCJzZXRPcHRpb24iLCJwYXJhbWV0ZXJzIiwiY3NzIiwib3Blbk1vZGFsIiwiY2xvc2VNb2RhbCIsImdldFRhZ3MiLCJ0YWdzU3RyaW5nIiwidGFncyIsInNwbGl0Iiwiam9pbiIsInNlbmQiLCJsYXN0Q29udGVudCIsImZvcmNlU2F2ZSIsImNvbnNvbGUiLCJsb2ciLCJkb2N1bWVudCIsInRpdGxlIiwidXNlcm5hbWUiLCJjb250ZXh0IiwidG9jIiwiaXMiLCJpZCIsIl9pZCIsInRleHQiLCJwb3N0IiwiZGF0YSIsImhhc093blByb3BlcnR5IiwidG9hc3QiLCJtZXNzYWdlIiwibm93IiwiRGF0ZSIsImRhdGUiLCJnZXRIb3VycyIsImdldE1pbnV0ZXMiLCJyZWRpcmVjdFRvRWRpdCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaHJlZiIsImRlbCIsImFqYXgiLCJ1cmwiLCJ0eXBlIiwic3VjY2VzcyIsIm5ld0RvY3VtZW50IiwiTWF0ZXJpYWxpemUiLCJyZWFkeSIsImxlYW5Nb2RhbCIsIkNvZGVNaXJyb3IiLCJmcm9tVGV4dEFyZWEiLCJvbiIsInNldEludGVydmFsIiwia2V5ZG93biIsImUiLCJrZXlDb2RlIiwic3RhcnQiLCJ0aGlzIiwic2VsZWN0aW9uU3RhcnQiLCJlbmQiLCJzZWxlY3Rpb25FbmQiLCIkdGhpcyIsInZhbHVlIiwic3Vic3RyaW5nIiwicHJldmVudERlZmF1bHQiLCJjdHJsS2V5Il0sIm1hcHBpbmdzIjoiQUFzQkEsUUFBQUEsY0FDQSxHQUFBQyxRQUFBLENBQ0EsR0FBQUMsR0FBQUMsUUFBQUMsV0FBQUMsTUFDQSxLQUFBSCxFQUFBSSxLQUNBQyxpQkFDQUEsZ0JBQUEsRUFDQUMsV0FBQSxXQUNBRCxnQkFBQSxFQUNBRCxNQUNBLFFBS0EsUUFBQUEsTUFDQSxHQUFBRyxHQUFBLEVBQ0EsTUFBQUMsRUFBQSxVQUFBQyxRQUFBRixFQUFBLEtBQUFDLEVBQUEsVUFBQUMsTUFBQSxLQUNBLElBQUFDLEdBQUFILEVBQUFOLFFBQUFDLFVBRUFRLEdBQUFBLEVBQUFDLFFBQUEsZUFBQSxrQkFDQUQsRUFBQUEsRUFBQUMsUUFBQSxpQkFBQSxrQkFDQSxJQUFBQyxHQUFBQyxPQUFBSCxFQUNBRixHQUFBLFNBQUFNLEtBQUFGLEdBR0EsUUFBQUcsaUJBQ0FoQixTQUNBUyxFQUFBLFdBQUFRLFNBQUEsT0FBQUMsWUFBQSxNQUNBVCxFQUFBLFNBQUFVLE9BQ0FWLEVBQUEsaUJBQUFTLFlBQUEsZ0JBQUFELFNBQUEsWUFHQVIsRUFBQSxXQUFBUSxTQUFBLE1BQUFDLFlBQUEsT0FDQVQsRUFBQSxTQUFBVyxPQUNBWCxFQUFBLFdBQUFTLFlBQUEsVUFBQUQsU0FBQSxnQkFDQVosTUFFQUwsU0FBQUEsUUFHQSxRQUFBcUIsd0JBQ0FaLEVBQUEsU0FBQWEsWUFBQSxpQkFHQSxRQUFBQyxvQkFDQXJCLFFBQUFzQixVQUFBLGNBQ0F0QixRQUFBdUIsVUFBQSxjQUFBLEdBQ0F2QixRQUFBdUIsVUFBQSxjQUFBLEdBQ0FoQixFQUFBLDJCQUFBYSxZQUFBLFFBR0EsUUFBQUksY0FDQSxRQUFBakIsRUFBQSxxQkFBQWtCLElBQUEsV0FDQWxCLEVBQUEscUJBQUFtQixZQUNBbkIsRUFBQSxxQkFBQW9CLGFBR0EsUUFBQUMsV0FDQSxHQUFBQyxHQUFBdEIsRUFBQSxTQUFBQyxNQUNBc0IsRUFBQUQsRUFBQUUsTUFBQSxTQUNBLE9BQUFELEdBQUFFLEtBQUEsTUNsRkEsUUFBQUMsUUFDQSxHQUFBakMsUUFBQUMsWUFBQWlDLGFBQUFDLFVBQ0EsR0FBQSxLQUFBNUIsRUFBQSxVQUFBQyxNQUFBLENBQ0E0QixRQUFBQyxJQUFBLGFBQ0EsSUFBQWIsSUFDQWMsVUFDQUMsTUFBQWhDLEVBQUEsVUFBQUMsTUFDQUMsUUFBQVQsUUFBQUMsV0FDQTZCLEtBQUFGLFVBQ0FZLFNBQUFqQyxFQUFBLGFBQUFDLE1BQ0FpQyxRQUFBbEMsRUFBQSxZQUFBQyxNQUNBa0MsSUFBQW5DLEVBQUEsUUFBQW9DLEdBQUEsY0FBQSxHQUdBLEtBQUFDLEtBQ0FwQixFQUFBcUIsSUFBQUQsR0FDQXJDLEVBQUEsU0FBQXFDLEdBQUEsZUFBQUUsS0FBQXRCLEVBQUFjLFNBQUFDLFFBRUFoQyxFQUFBd0MsS0FBQSxPQUFBdkIsRUFBQSxTQUFBd0IsR0FDQSxHQUFBQSxJQUFBQSxFQUFBQyxlQUFBLFNBQUEsQ0FDQUwsR0FBQUksRUFBQUosR0FDQU0sTUFBQUYsRUFBQUcsUUFBQSxJQUNBLElBQUFDLEdBQUEsR0FBQUMsTUFDQUMsRUFBQUYsRUFBQUcsV0FBQSxJQUFBSCxFQUFBSSxZQUNBakQsR0FBQSxjQUFBdUMsS0FBQSx5QkFDQVEsR0FDQXBCLFlBQUFWLEVBQUFjLFNBQUE3QixRQUNBdUMsRUFBQVMsaUJBQUFDLE9BQUFDLFNBQUFDLEtBQ0EsSUFBQWhCLFFBQ0FNLE9BQUEsd0NBQUEsV0FFQUEsT0FBQSxtQ0FBQSxLQUdBLFFBQUFXLE9BQ0EsSUFBQWpCLEdBQ0FyQyxFQUFBdUQsTUFDQUMsSUFBQSxRQUFBbkIsR0FDQW9CLEtBQUEsU0FDQUMsUUFBQSxTQUFBakIsR0FDQVUsT0FBQUMsU0FBQUMsS0FBQSxPQUdBVixNQUFBLHFCQUFBLEtBR0EsUUFBQWdCLGVBQ0FSLE9BQUFDLFNBQUFDLEtBQUEsSUQvQ0EsR0FBQVYsT0FBQWlCLFlBQUFqQixNQUNBcEQsU0FBQSxFQUNBb0MsWUFBQSxHQUNBOUIsZ0JBQUEsRUFDQUosT0FFQU8sR0FBQStCLFVBQUE4QixNQUFBLFdBQ0E3RCxFQUFBLGtCQUFBOEQsWUFDQTlELEVBQUEsU0FBQXFDLElBQUE3QixTQUFBLFVBQ0FsQixhQUdBRyxRQUFBc0UsV0FBQUMsYUFBQWhFLEVBQUEsWUFBQSxJQUNBUCxRQUFBd0UsR0FBQSxTQUFBM0UsWUFHQTZELE9BQUFlLFlBQUEsV0FDQSxLQUFBbEUsRUFBQSxVQUFBQyxPQUFBLEtBQUFELEVBQUEsWUFBQUMsT0FDQXlCLFFBQ0EsT0FtRUExQixFQUFBLFlBQUFtRSxRQUFBLFNBQUFDLEdBRUEsR0FBQSxJQUFBQSxFQUFBQyxRQUFBLENBQ0EsR0FBQUMsR0FBQUMsS0FBQUMsZUFDQUMsRUFBQUYsS0FBQUcsYUFDQUMsRUFBQTNFLEVBQUF1RSxNQUNBSyxFQUFBRCxFQUFBMUUsS0FDQTBFLEdBQUExRSxJQUFBMkUsRUFBQUMsVUFBQSxFQUFBUCxHQUFBLElBQUFNLEVBQUFDLFVBQ0FKLElBQ0FGLEtBQUFDLGVBQUFELEtBQUFHLGFBQUFKLEVBQUEsRUFDQUYsRUFBQVUsb0JBR0E5RSxFQUFBK0IsVUFBQW9DLFFBQUEsU0FBQUMsR0FFQSxHQURBdkMsUUFBQUMsSUFBQXNDLEVBQUFDLFNBQ0FELEVBQUFXLFFBQUEsQ0FDQSxPQUFBWCxFQUFBQyxTQUVBLElBQUEsSUFDQTNDLE1BQ0EsTUFFQSxLQUFBLElBQ0FpQyxhQUNBLE1BRUEsS0FBQSxJQUNBcEQsZUFDQSxNQUVBLEtBQUEsSUFDQU8sbUJBR0FzRCxFQUFBVSIsImZpbGUiOiJidW5kbGUuanMiLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdG9hc3QgPSBNYXRlcmlhbGl6ZS50b2FzdDtcbnZhciBwcmV2aWV3ID0gZmFsc2U7XG52YXIgbGFzdENvbnRlbnQgPSBcIlwiO1xudmFyIHdhaXRGb3JDb252ZXJ0ID0gZmFsc2U7XG52YXIgZWRpdGV1cjtcblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7XG4gICQoJy5tb2RhbC10cmlnZ2VyJykubGVhbk1vZGFsKCk7XG4gICQoJy5saW5rLScgKyBpZCkuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuICB0b01hcmtkb3duKCk7XG5cbiAgLy8gSW5pdGlhbGlzYWlvbiBkZSBsJ8OpZGl0ZXVyXG4gIGVkaXRldXIgPSBDb2RlTWlycm9yLmZyb21UZXh0QXJlYSgkKFwidGV4dGFyZWFcIilbMF0pO1xuICBlZGl0ZXVyLm9uKFwiY2hhbmdlXCIsIHRvTWFya2Rvd24pO1xuXG4gIC8vIFNhdXZlZ2FyZGUgYXV0b21hdGlxdWUgdG91dGVzIGxlcyBtaW51dGVzXG4gIHdpbmRvdy5zZXRJbnRlcnZhbChmdW5jdGlvbigpIHtcbiAgICBpZiAoJCgnI3RpdGxlJykudmFsKCkgIT09IFwiXCIgJiYgJCgnI2NvbnRlbnQnKS52YWwoKSAhPT0gXCJcIilcbiAgICAgIHNlbmQoKTtcbiAgfSwgNjAwMDApO1xufSk7XG5cbmZ1bmN0aW9uIHRvTWFya2Rvd24oKSB7XG4gIGlmIChwcmV2aWV3KSB7XG4gICAgdmFyIGNoYXJDb3VudCA9IGVkaXRldXIuZ2V0VmFsdWUoKS5sZW5ndGg7XG4gICAgaWYgKGNoYXJDb3VudCA8IDEwMDAwKSBtZCgpO1xuICAgIGVsc2UgaWYgKCF3YWl0Rm9yQ29udmVydCkge1xuICAgICAgd2FpdEZvckNvbnZlcnQgPSB0cnVlO1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgd2FpdEZvckNvbnZlcnQgPSBmYWxzZTtcbiAgICAgICAgbWQoKTtcbiAgICAgIH0sIDE1MDApO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBtZCgpIHtcbiAgdmFyIHRpdHJlID0gXCJcIjtcbiAgaWYgKCQoJyN0aXRsZScpLnZhbCgpICE9PSBcIlwiKSB0aXRyZSA9IFwiIyBcIiArICQoJyN0aXRsZScpLnZhbCgpICsgXCJcXG5cIjtcbiAgdmFyIGNvbnRlbnQgPSB0aXRyZSArIGVkaXRldXIuZ2V0VmFsdWUoKTtcbiAgLy9jb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oPChbXj5dKyk+KS9pZywgXCJcIik7XG4gIGNvbnRlbnQgPSBjb250ZW50LnJlcGxhY2UoLyg8c2NyaXB0PikvaWcsIFwiW0phdmFzY3JpcHRdXFxuXCIpO1xuICBjb250ZW50ID0gY29udGVudC5yZXBsYWNlKC8oPFxcL3NjcmlwdD4pL2lnLCBcIlxcblsvSmF2YXNjcmlwdF1cIik7XG4gIHZhciBtZENvbnRlbnQgPSBtYXJrZWQoY29udGVudCk7XG4gICQoXCIjdmlld1wiKS5odG1sKG1kQ29udGVudCk7XG59XG5cbmZ1bmN0aW9uIHRvZ2dsZVByZXZpZXcoKSB7XG4gIGlmIChwcmV2aWV3KSB7XG4gICAgJCgnI2VkaXRvcicpLmFkZENsYXNzKCdtMTInKS5yZW1vdmVDbGFzcygnbTYnKTtcbiAgICAkKCcjdmlldycpLmhpZGUoKTtcbiAgICAkKFwiLmZhLWV5ZS1zbGFzaFwiKS5yZW1vdmVDbGFzcygnZmEtZXllLXNsYXNoJykuYWRkQ2xhc3MoJ2ZhLWV5ZScpO1xuXG4gIH0gZWxzZSB7XG4gICAgJCgnI2VkaXRvcicpLmFkZENsYXNzKCdtNicpLnJlbW92ZUNsYXNzKCdtMTInKTtcbiAgICAkKCcjdmlldycpLnNob3coKTtcbiAgICAkKFwiLmZhLWV5ZVwiKS5yZW1vdmVDbGFzcygnZmEtZXllJykuYWRkQ2xhc3MoJ2ZhLWV5ZS1zbGFzaCcpO1xuICAgIG1kKCk7XG4gIH1cbiAgcHJldmlldyA9ICFwcmV2aWV3O1xufVxuXG5mdW5jdGlvbiB0b2dnbGVOdW1iZXJlZFRpdGxlcygpIHtcbiAgJChcIiN2aWV3XCIpLnRvZ2dsZUNsYXNzKCdudW1iZXJlZC12aWV3Jyk7XG59XG5cbmZ1bmN0aW9uIHRvZ2dsZUZ1bGxzY3JlZW4oKSB7XG4gIGlmIChlZGl0ZXVyLmdldE9wdGlvbihcImZ1bGxTY3JlZW5cIikpXG4gICAgZWRpdGV1ci5zZXRPcHRpb24oXCJmdWxsU2NyZWVuXCIsIGZhbHNlKTtcbiAgZWxzZSBlZGl0ZXVyLnNldE9wdGlvbihcImZ1bGxTY3JlZW5cIiwgdHJ1ZSk7XG4gICQoJy5idG4tZnVsbHNjcmVlbi1kaXNhYmxlJykudG9nZ2xlQ2xhc3MoJ2hpZGUnKTtcbn1cblxuZnVuY3Rpb24gcGFyYW1ldGVycygpIHtcbiAgaWYgKCQoXCIjbW9kYWwtcGFyYW1ldGVyc1wiKS5jc3MoJ2Rpc3BsYXknKSA9PSBcIm5vbmVcIilcbiAgICAkKCcjbW9kYWwtcGFyYW1ldGVycycpLm9wZW5Nb2RhbCgpO1xuICBlbHNlICQoJyNtb2RhbC1wYXJhbWV0ZXJzJykuY2xvc2VNb2RhbCgpO1xufVxuXG5mdW5jdGlvbiBnZXRUYWdzKCkge1xuICB2YXIgdGFnc1N0cmluZyA9ICQoXCIjdGFnc1wiKS52YWwoKTtcbiAgdmFyIHRhZ3MgPSB0YWdzU3RyaW5nLnNwbGl0KC9bLDtdICovKTtcbiAgcmV0dXJuIHRhZ3Muam9pbignLCAnKTtcbn1cblxuLy9HZXN0aW9uIGRlcyB0b3VjaGVzIGNsYXZpZXJzIHNww6ljaWFsZXNcbiQoXCJ0ZXh0YXJlYVwiKS5rZXlkb3duKGZ1bmN0aW9uKGUpIHtcbiAgLy8gVGFidWxhdGlvbiBkYW5zIGwnw6lkaXRldXJcbiAgaWYgKGUua2V5Q29kZSA9PT0gOSkge1xuICAgIHZhciBzdGFydCA9IHRoaXMuc2VsZWN0aW9uU3RhcnQ7XG4gICAgdmFyIGVuZCA9IHRoaXMuc2VsZWN0aW9uRW5kO1xuICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XG4gICAgdmFyIHZhbHVlID0gJHRoaXMudmFsKCk7XG4gICAgJHRoaXMudmFsKHZhbHVlLnN1YnN0cmluZygwLCBzdGFydCkgKyBcIlxcdFwiICsgdmFsdWUuc3Vic3RyaW5nKFxuICAgICAgZW5kKSk7XG4gICAgdGhpcy5zZWxlY3Rpb25TdGFydCA9IHRoaXMuc2VsZWN0aW9uRW5kID0gc3RhcnQgKyAxO1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgfVxufSk7XG4kKGRvY3VtZW50KS5rZXlkb3duKGZ1bmN0aW9uKGUpIHtcbiAgY29uc29sZS5sb2coZS5rZXlDb2RlKTtcbiAgaWYgKGUuY3RybEtleSkge1xuICAgIHN3aXRjaCAoZS5rZXlDb2RlKSB7XG4gICAgICAvL0NUUkwrUyA6IFNhdXZlZ2FyZGUgbWFudWVsbGVcbiAgICAgIGNhc2UgODM6XG4gICAgICAgIHNlbmQoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICAvL0NUUkwrTiA6IE5vdXZlYXUgZG9jdW1lbnRcbiAgICAgIGNhc2UgNzg6XG4gICAgICAgIG5ld0RvY3VtZW50KCk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgLy9DVFJMK08gOiBUb2dnbGUgUHJldmlld1xuICAgICAgY2FzZSA3OTpcbiAgICAgICAgdG9nZ2xlUHJldmlldygpO1xuICAgICAgICBicmVhaztcbiAgICAgIC8vQ1RSTCtPIDogVG9nZ2xlIEZ1bGxTY3JlZW5cbiAgICAgIGNhc2UgODA6XG4gICAgICAgIHRvZ2dsZUZ1bGxzY3JlZW4oKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgfVxufSk7XG4iLCJmdW5jdGlvbiBzZW5kKCkge1xuICAgIGlmIChlZGl0ZXVyLmdldFZhbHVlKCkgIT0gbGFzdENvbnRlbnQgfHwgZm9yY2VTYXZlKVxuICAgICAgICBpZiAoJCgnI3RpdGxlJykudmFsKCkgIT09IFwiXCIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiU2F1dmVnYXJkZVwiKTtcbiAgICAgICAgICAgIHZhciBwYXJhbWV0ZXJzID0ge1xuICAgICAgICAgICAgICAgIGRvY3VtZW50OiB7XG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAkKCcjdGl0bGUnKS52YWwoKSxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogZWRpdGV1ci5nZXRWYWx1ZSgpLFxuICAgICAgICAgICAgICAgICAgICB0YWdzOiBnZXRUYWdzKCksXG4gICAgICAgICAgICAgICAgICAgIHVzZXJuYW1lOiAkKCcjdXNlcm5hbWUnKS52YWwoKSxcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dDogJCgnI2NvbnRleHQnKS52YWwoKSxcbiAgICAgICAgICAgICAgICAgICAgdG9jOiAkKCcjdG9jJykuaXMoJzpjaGVja2VkJykgfHwgZmFsc2VcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKGlkICE9PSAwKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1ldGVycy5faWQgPSBpZDtcbiAgICAgICAgICAgICAgICAkKCcubGluay0nICsgaWQgKyBcIiAuZG9jLXRpdGxlXCIpLnRleHQocGFyYW1ldGVycy5kb2N1bWVudC50aXRsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkLnBvc3QoXCIvYXBpXCIsIHBhcmFtZXRlcnMsIGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgICAgICBpZiAoZGF0YSAmJiAhZGF0YS5oYXNPd25Qcm9wZXJ0eSgnZXJyb3InKSkge1xuICAgICAgICAgICAgICAgICAgICBpZCA9IGRhdGEuaWQ7XG4gICAgICAgICAgICAgICAgICAgIHRvYXN0KGRhdGEubWVzc2FnZSwgMjAwMCk7XG4gICAgICAgICAgICAgICAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IG5vdy5nZXRIb3VycygpICsgXCI6XCIgKyBub3cuZ2V0TWludXRlcygpO1xuICAgICAgICAgICAgICAgICAgICAkKFwiI2xhc3Qtc2F2ZVwiKS50ZXh0KFwiRGVybmnDqHJlIHNhdXZlZ2FyZGUgw6AgXCIgK1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZSk7XG4gICAgICAgICAgICAgICAgICAgIGxhc3RDb250ZW50ID0gcGFyYW1ldGVycy5kb2N1bWVudC5jb250ZW50O1xuICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5yZWRpcmVjdFRvRWRpdCkgd2luZG93LmxvY2F0aW9uLmhyZWYgPVxuICAgICAgICAgICAgICAgICAgICAgICAgJy8nICsgaWQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHRvYXN0KFwiUHJvYmzDqG1lIHNlcnZldXIuIERvY3VtZW50IG5vbiBzYXV2w6kuXCIsMjAwMCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHRvYXN0KFwiUGFzIGRlIHRpdHJlLiBEb2N1bWVudCBub24gc2F1dsOpXCIsIDIwMDApO1xufVxuXG5mdW5jdGlvbiBkZWwoKSB7XG4gICAgaWYgKGlkICE9PSAwKVxuICAgICAgICAkLmFqYXgoe1xuICAgICAgICAgICAgdXJsOiBcIi9hcGkvXCIgKyBpZCxcbiAgICAgICAgICAgIHR5cGU6IFwiREVMRVRFXCIsXG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnLyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIGVsc2UgdG9hc3QoXCJEb2N1bWVudCBub24gc2F1dsOpXCIsIDIwMDApO1xufVxuXG5mdW5jdGlvbiBuZXdEb2N1bWVudCgpIHtcbiAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvJztcbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
