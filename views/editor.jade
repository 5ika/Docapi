extends layout

block content
    .user
        a(href='/user/profile')
            .chip
                .fa.fa-user
                if(user)
                    |  #{user}
                else
                    | No user
    .row
        #editor.col.m6.s12    
            .col.s12.m12
                a(onclick="send()").btn.btn-flat.waves-effect.waves-light Sauver
                a.waves-effect.waves-light.btn.btn-flat.modal-trigger(href='#modal-list') Liste
                a(data-target='modal-confirm').btn.btn-flat.waves-effect.waves-light.modal-trigger Supprimer
                if(document)
                    a(href="/api/dl/#{document._id}.txt" target='_blank').waves-effect.waves-light.btn.btn-flat Télécharger
                    a(onclick="newDocument()").btn.btn-flat.waves-effect.waves-light Nouveau
                a(onclick="togglePreview()").btn.btn-flat.waves-effect.waves-light#preview-btn Preview
                #last-save
            form(onSubmit="return false;").col.m12.s12
                .row
                    .input-field.col.s12
                        if(document)
                            input#title.editable(type="text" value='#{document.title}' autocomplete="off")
                        else
                            input#title.editable(type="text" placeholder="Titre du document")
                .row
                    .input-field.col.s12
                        if(document)
                            textarea(placeholder='Contenu du document...')#content.materialize-textarea.editable #{document.content}
                        else 
                            textarea(placeholder='Contenu du document...')#content.materialize-textarea.editable
        #view.col.m6.s12
                    
block script
    script(src="/js/editor.js")
    script
        if(document)
            | var id = "#{document._id}";
        else
            | var id = 0;
            
block modals
    #modal-list.modal.bottom-sheet
        .modal-content
            h4 Documents
            if(list)
                .collection
                    each doc in list
                        a.collection-item(href='/#{doc._id}' class='link-#{doc._id}') #{doc.title}
            else
                | Pas de document
                
    #modal-confirm.modal
        .modal-content
            h5 Êtes-vous certain de vouloir supprimer ?
        .modal-footer
            a(onclick="del()").btn.btn-flat.btn-lg.waves-effect.modal-action.modal-close Oui
            a.btn.btn-flat.btn-lg.waves-effect.modal-action.modal-close Non
